<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Not Bad</title>
  
  <subtitle>ç‹¬ç«‹æ€è€ƒï¼ŒåšæŒå†™ä½œ</subtitle>
  <link href="https://blog.domc.me/atom.xml" rel="self"/>
  
  <link href="https://blog.domc.me/"/>
  <updated>2021-07-16T04:29:31.986Z</updated>
  <id>https://blog.domc.me/</id>
  
  <author>
    <name>Dom Chan</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Kubernetes Gateway API</title>
    <link href="https://blog.domc.me/2021/05/10/k8s-gateway-api/"/>
    <id>https://blog.domc.me/2021/05/10/k8s-gateway-api/</id>
    <published>2021-05-10T00:14:15.000Z</published>
    <updated>2021-07-16T04:29:31.986Z</updated>
    
    
    <summary type="html">&lt;ul&gt;
&lt;li&gt;&lt;h1 id=&quot;ä»€ä¹ˆæ˜¯-Kubernetes-Gateway-API&quot;&gt;&lt;a href=&quot;#ä»€ä¹ˆæ˜¯-Kubernetes-Gateway-API&quot; class=&quot;headerlink&quot; title=&quot;ä»€ä¹ˆæ˜¯ Kubernetes Gateway API&quot;&gt;&lt;/a&gt;ä»€ä¹ˆæ˜¯ Kubernetes Gateway API&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;Kubernetes Gateway APIï¼ˆä»¥ä¸‹ç®€ç§° &lt;code&gt;KGA&lt;/code&gt;ï¼‰æ˜¯ç”± sig-network å°ç»„æå‡ºçš„ï¼Œç”¨äºå¸®åŠ©ç”¨æˆ·åœ¨ K8S ä¸­å¯¹æœåŠ¡ç½‘ç»œè¿›è¡Œå»ºæ¨¡çš„èµ„æºçš„é›†åˆã€‚&lt;/li&gt;
&lt;li&gt;å®ƒé€šè¿‡æä¾›æ ‡å‡†åŒ–çš„æ¥å£ï¼Œå…è®¸å„ä¸ªä¾›åº”å•†æä¾›è‡ªå·±çš„å®ç°æ–¹å¼ï¼Œæ¥å¸®åŠ©ç”¨æˆ·è§„åˆ’é›†ç¾¤å†…çš„æœåŠ¡ç½‘ç»œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;h1 id=&quot;æ¼”è¿›å†å²&quot;&gt;&lt;a href=&quot;#æ¼”è¿›å†å²&quot; class=&quot;headerlink&quot; title=&quot;æ¼”è¿›å†å²&quot;&gt;&lt;/a&gt;æ¼”è¿›å†å²&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;æœ€åˆ K8S æä¾›äº† &lt;code&gt;Ingress&lt;/code&gt; API æ¥è®©ç”¨æˆ·å¯ä»¥å®šä¹‰é›†ç¾¤çš„å…¥å£ç½‘ç»œã€‚éšç€æµé‡ç®¡ç†ï¼ˆç†”æ–­ï¼Œé™æµï¼Œç°åº¦ï¼‰ç­‰éœ€æ±‚çš„å¢åŠ ï¼Œæœ€åˆçš„ &lt;code&gt;Ingress&lt;/code&gt; çš„å®šä¹‰å·²ç»æ— æ³•æ»¡è¶³ï¼Œå› æ­¤ç¤¾åŒºå¼€å§‹åˆ†è£‚å‡ºäº†ä¸åŒçš„å®ç°æ–¹å¼ã€‚&lt;ul&gt;
&lt;li&gt;åˆ©ç”¨ &lt;code&gt;CRD&lt;/code&gt; æ‰©å±• &lt;code&gt;Ingress&lt;/code&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://dave.cheney.net/paste/ingress-is-dead-long-live-ingressroute.pdf&quot;&gt;https://dave.cheney.net/paste/ingress-is-dead-long-live-ingressroute.pdf&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;åˆ©ç”¨ &lt;code&gt;Annotation&lt;/code&gt; æ‰©å±•  &lt;code&gt;Ingress&lt;/code&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/annotations/&quot;&gt;nginx-controller&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è¿™äº›æ–¹å¼è™½ç„¶èƒ½è§£å†³ç°æœ‰çš„é—®é¢˜ï¼Œä½†ä¹Ÿå¯¼è‡´äº†&lt;ul&gt;
&lt;li&gt;æ²¡æœ‰ç»Ÿä¸€çš„æ ‡å‡†ï¼Œå„ä¸ª ingress-controller æŒ‰è‡ªå·±çš„æ–¹å¼å®ç°&lt;/li&gt;
&lt;li&gt;æ²¡æœ‰å¯ç§»æ¤æ€§&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å› æ­¤ KGA åº”è¿è€Œç”Ÿï¼ŒKGA éœ€è¦èƒ½è®©ç”¨æˆ·å¾ˆæ–¹ä¾¿çš„ä½¿ç”¨ä»¥ä¸‹åŠŸèƒ½&lt;ul&gt;
&lt;li&gt;&lt;h3 id=&quot;æµé‡ç®¡ç†&quot;&gt;&lt;a href=&quot;#æµé‡ç®¡ç†&quot; class=&quot;headerlink&quot; title=&quot;æµé‡ç®¡ç†&quot;&gt;&lt;/a&gt;æµé‡ç®¡ç†&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;HTTP æµé‡èƒ½å¤ŸæŒ‰ &lt;code&gt;Header&lt;/code&gt;, &lt;code&gt;URI&lt;/code&gt; è·¯ç”±&lt;/li&gt;
&lt;li&gt;æµé‡æŒ‰æƒé‡è·¯ç”±&lt;/li&gt;
&lt;li&gt;æµé‡é•œåƒ&lt;/li&gt;
&lt;li&gt;TCP å’Œ UDP ç­‰è·¯ç”±&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;h3 id=&quot;é¢å‘è§’è‰²çš„è®¾è®¡&quot;&gt;&lt;a href=&quot;#é¢å‘è§’è‰²çš„è®¾è®¡&quot; class=&quot;headerlink&quot; title=&quot;é¢å‘è§’è‰²çš„è®¾è®¡&quot;&gt;&lt;/a&gt;é¢å‘è§’è‰²çš„è®¾è®¡&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;å°† Routing å’Œ Service çš„è§’è‰²åˆ†ç¦»&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;h3 id=&quot;æ‰©å±•æ€§&quot;&gt;&lt;a href=&quot;#æ‰©å±•æ€§&quot; class=&quot;headerlink&quot; title=&quot;æ‰©å±•æ€§&quot;&gt;&lt;/a&gt;æ‰©å±•æ€§&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;æ”¯æŒå±‚çº§é…ç½®ï¼Œç”¨æˆ·å¯ä»¥åœ¨ä¸Šå±‚é…ç½®ä¸­æ·»åŠ æˆ–è¦†ç›–ä¸‹å±‚é…ç½®ä¸­çš„å±æ€§&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;h3 id=&quot;çµæ´»ä¸€è‡´æ€§&quot;&gt;&lt;a href=&quot;#çµæ´»ä¸€è‡´æ€§&quot; class=&quot;headerlink&quot; title=&quot;çµæ´»ä¸€è‡´æ€§&quot;&gt;&lt;/a&gt;çµæ´»ä¸€è‡´æ€§&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;KGA æä¾›äº†ä¸‰ç§çº§åˆ«çš„ API&lt;ul&gt;
&lt;li&gt;core&lt;ul&gt;
&lt;li&gt;å¿…é¡»å®ç°&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;extended&lt;ul&gt;
&lt;li&gt;å¯ä»¥ä¸å®ç°ï¼Œå¦‚æœå®ç°å¿…é¡»ä¿è¯ç§»æ¤æ€§&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;custom&lt;ul&gt;
&lt;li&gt;å„ä¸ª controller å¯ä»¥è‡ªå®šä¹‰ï¼Œä¸”ä¸éœ€è¦æä¾›å¯ç§»æ¤ä¿è¯&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    
    <category term="kubernetes" scheme="https://blog.domc.me/tags/kubernetes/"/>
    
    <category term="network" scheme="https://blog.domc.me/tags/network/"/>
    
  </entry>
  
  <entry>
    <title>è®°ä¸€æ¬¡ WebSocket è¿æ¥æ³„éœ²æ’æŸ¥</title>
    <link href="https://blog.domc.me/2019/12/29/websocket-leak/"/>
    <id>https://blog.domc.me/2019/12/29/websocket-leak/</id>
    <published>2019-12-29T16:34:34.000Z</published>
    <updated>2021-07-16T04:29:31.986Z</updated>
    
    
    <summary type="html">&lt;p&gt;ä¹‹å‰é‡æ„äº†æŸä¸ª &lt;code&gt;WebSocket&lt;/code&gt; æœåŠ¡ï¼Œåœ¨è¿è¡Œäº†ä¸€æ®µæ—¶é—´ä¹‹åæœ‰åŒäº‹ååº”è¯¥æœåŠ¡å¡é¡¿ï¼Œæ—¶å¸¸è·å–ä¸åˆ°æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯æˆ‘å°è¯•å¼€å§‹å¤ç°è¯¥æƒ…å†µã€‚&lt;/p&gt;
&lt;p&gt;æ‰“å¼€æµè§ˆå™¨è·³è½¬åˆ°ç›¸åº”çš„é¡µé¢åï¼Œå‘ç°æ•°æ®ç«‹åˆ»å°±åŠ è½½äº†å‡ºæ¥ï¼Œä½†æ˜¯å¤šæ¬¡åˆ·æ–°é¡µé¢ä¹‹åï¼Œå°±å¼€å§‹å‡ºç°æ— æ³•åŠ è½½æ•°æ®çš„æƒ…å†µã€‚æ‰“å¼€æ§åˆ¶å°ï¼Œå‘ç°æŠ¥äº†å¦‚ä¸‹çš„é”™è¯¯ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;WebSocket connection to &lt;span class=&quot;string&quot;&gt;&amp;#x27;ws://xxxxx/&amp;#x27;&lt;/span&gt; failed: Error &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; connection establishment: net::ERR_CONNECTION_FAILED&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;ä¸€èˆ¬æ¥è¯´å‡ºç°è¯¥é—®é¢˜å¯èƒ½æ˜¯å› ä¸ºç½‘ç»œé—®é¢˜æˆ–è€…è¿æ¥è¶…æ—¶å¼•èµ·çš„ï¼Œåœ¨æ’é™¤äº†è‡ªèº«ç½‘ç»œé—®é¢˜çš„å‰æä¸‹ï¼Œæˆ‘è°ƒå¤§äº† WebSocet çš„è¿æ¥è¶…æ—¶æ—¶é—´ã€‚ä½†è¿˜æ˜¯å‡ºç°äº†ä¸Šè¿°çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;p&gt;æ¥ç€æˆ‘çŒœæƒ³æ˜¯ä¸æ˜¯æˆ‘ä»¬çš„é•¿è¿æ¥ç½‘å…³å‡ºäº†é—®é¢˜ã€‚äºæ˜¯æˆ‘æŸ¥çœ‹äº†ç½‘å…³çš„æ—¥å¿—ï¼Œå‘ç°ç½‘å…³å‹æ ¹å°±æ²¡æ¥æ”¶åˆ°å‡ºç° &lt;code&gt;ERR_CONNECTION_FAILED&lt;/code&gt; é”™è¯¯çš„è¿æ¥ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯æˆ‘ç¡®å®šæ˜¯ä¹‹å‰é‡æ„çš„é¡¹ç›®é—®é¢˜ã€‚&lt;/p&gt;</summary>
    
    
    
    
    <category term="issues" scheme="https://blog.domc.me/tags/issues/"/>
    
    <category term="websocket" scheme="https://blog.domc.me/tags/websocket/"/>
    
  </entry>
  
  <entry>
    <title>ExitCode: 128 ä¹‹æ— ä»»ä½•é”™è¯¯ä¿¡æ¯</title>
    <link href="https://blog.domc.me/2019/11/21/exit-code-128/"/>
    <id>https://blog.domc.me/2019/11/21/exit-code-128/</id>
    <published>2019-11-21T02:04:24.000Z</published>
    <updated>2021-07-16T04:29:31.986Z</updated>
    
    
    <summary type="html">&lt;p&gt;ä»Šå¤©åœ¨ä½¿ç”¨ &lt;code&gt;Drone CI&lt;/code&gt; æ„å»ºé¡¹ç›®æ—¶å‡ºç°ä¸€ä¸ªå¼‚å¸¸å¥‡æ€ªçš„é”™è¯¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/exitcode-128/drone-error.png&quot; alt=&quot;error&quot;&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ &lt;code&gt;clone&lt;/code&gt; æŸåˆ†æ”¯ä»£ç æ—¶æ„å»ºç›´æ¥å¤±è´¥é€€å‡ºäº†ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæˆ‘æ’æŸ¥äº† &lt;code&gt;rpc error&lt;/code&gt;ï¼Œå‘ç°è¿™ä¸ªé”™è¯¯å‡ºç°çš„åŸå› æ˜¯æ­£åœ¨è·å– &lt;code&gt;Pod&lt;/code&gt; çš„ &lt;code&gt;Log&lt;/code&gt; çš„è¿‡ç¨‹ä¸­ï¼ŒPod è¢«åˆ é™¤äº†ã€‚&lt;/p&gt;
&lt;p&gt;å½“æ—¶æˆ‘å°±è§‰å¾—å¾ˆå¥‡æ€ªï¼Œå°±ç®—å› ä¸º &lt;code&gt;Step&lt;/code&gt; æ‰§è¡Œå¤±è´¥è¦åˆ é™¤ Podï¼Œé‚£ä¹Ÿä¼šå…ˆåœæ­¢ &lt;code&gt;getLog&lt;/code&gt;ï¼Œè€Œä¸æ˜¯åœ¨ getLog çš„è¿‡ç¨‹ä¸­ç›´æ¥åˆ é™¤ Podã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯ä½¿ç”¨äº† &lt;code&gt;kubectl describe&lt;/code&gt; äº†è¿™ä¸ª Podï¼Œå‘ç°è¯¥ Container çš„ &lt;code&gt;Exit Code&lt;/code&gt; æ˜¯ 128ã€‚è¯´æ˜æ˜¯è¯¥ Container æ‰§è¡Œæ—¶å‡ºé”™ï¼Œè‡ªå·±é€€å‡ºçš„ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ä»ä¸Šå›¾çš„æ—¥å¿—ä¸­æ¥çœ‹ Container åº”è¯¥æ˜¯æ‰§è¡ŒæˆåŠŸäº†ï¼Œå¹¶æ²¡æœ‰å‡ºç°é”™è¯¯çš„æ—¥å¿—ã€‚é‚£ä¸ºä»€ä¹ˆè¯¥ Container çš„é€€å‡ºç æ˜¯ 128 è€Œé 0 å‘¢ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯æˆ‘å¼€å§‹æ€€ç–‘æ˜¯ä¸æ˜¯ &lt;code&gt;git checkout -b master&lt;/code&gt; æ—¶å‡ºç°äº†é”™è¯¯ï¼Œäºæ˜¯æˆ‘åœ¨ Docker å®¹å™¨ä¸­æ¨¡æ‹Ÿäº†è¯¥ Step çš„æ­¥éª¤ï¼Œ&lt;code&gt;git checkout -b master | echo $?&lt;/code&gt;ï¼Œå‘ç°å³ä½¿æ˜¯æ˜¾ç¤º &lt;code&gt;Already on master&lt;/code&gt; å®ƒçš„é€€å‡ºç ä¹Ÿæ˜¯ 0ã€‚äºæ˜¯æ’é™¤äº†æ˜¯ git å‡ºé”™çš„å¯èƒ½æ€§ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆé—®é¢˜å‡ºåœ¨å“ªå‘¢ï¼Ÿ&lt;/p&gt;</summary>
    
    
    
    
    <category term="issues" scheme="https://blog.domc.me/tags/issues/"/>
    
    <category term="ci/cd" scheme="https://blog.domc.me/tags/ci-cd/"/>
    
    <category term="drone" scheme="https://blog.domc.me/tags/drone/"/>
    
    <category term="devops" scheme="https://blog.domc.me/tags/devops/"/>
    
    <category term="kubernetes" scheme="https://blog.domc.me/tags/kubernetes/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•å°†Drone CIè°ƒåº¦åˆ°Virtual Kubelet</title>
    <link href="https://blog.domc.me/2019/11/18/drone-virtual-kublet/"/>
    <id>https://blog.domc.me/2019/11/18/drone-virtual-kublet/</id>
    <published>2019-11-18T23:53:30.000Z</published>
    <updated>2021-07-16T04:29:31.986Z</updated>
    
    
    <summary type="html">&lt;h2 id=&quot;ä»€ä¹ˆæ˜¯-virtual-kubelet&quot;&gt;&lt;a href=&quot;#ä»€ä¹ˆæ˜¯-virtual-kubelet&quot; class=&quot;headerlink&quot; title=&quot;ä»€ä¹ˆæ˜¯ virtual kubelet&quot;&gt;&lt;/a&gt;ä»€ä¹ˆæ˜¯ virtual kubelet&lt;/h2&gt;&lt;p&gt;ä»¥ä¸‹æ˜¯æ¥è‡ª &lt;a href=&quot;https://github.com/virtual-kubelet/virtual-kubelet#virtual-kubelet&quot;&gt;Virtual Kubelet&lt;/a&gt; é¡¹ç›®çš„æ–‡æ¡£çš„ä¸­æ–‡ç¿»è¯‘ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Virtual Kubelet æ˜¯å¼€æºçš„ Kubernetes kubelet çš„å®ç°ï¼Œå®ƒå¯ä»¥ä¼ªè£…æˆ Kubelet å°† Kubernetes è¿æ¥åˆ°å…¶ä»– APIã€‚è¿™æ ·å°±å…è®¸ Node çš„èƒŒåç”±å…¶ä»–æœåŠ¡æ”¯æ’‘ï¼Œä¾‹å¦‚ï¼šACI, AWS Fargate, IoT Edgeã€‚Virtual Kubelet çš„ä¸»è¦ä½œç”¨æ˜¯æ‰©å±•æ— æœåŠ¡å™¨ï¼ˆServerlessï¼‰å¹³å°ï¼Œè®©å®ƒèƒ½å¤Ÿä¸ Kubernetes é€šä¿¡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä»¥ &lt;code&gt;é˜¿é‡Œäº‘ECI&lt;/code&gt; ä¸ºä¾‹ï¼ˆä»¥ä¸‹å‡ä»¥ ECI ä»£æŒ‡ Virtual Kubeletï¼‰ï¼ŒECI æ˜¯é˜¿é‡Œäº‘çš„å¼¹æ€§å®¹å™¨å®ä¾‹ã€‚å¯ä»¥å°†æ¯å° ECI å®ä¾‹çœ‹ä½œæ˜¯ä¸€ä¸ª &lt;code&gt;Container&lt;/code&gt;ï¼Œæ‰€ä»¥å®ƒçš„åˆ›å»ºå’Œé”€æ¯æ˜¯å¾ˆå»‰ä»·çš„ã€‚åŒæ—¶å®ƒæ‹¥æœ‰å¯åŠ¨å¿«ï¼ˆç§’çº§ï¼‰ã€æˆæœ¬ä½ï¼ˆæŒ‰è¿è¡Œçš„ç§’æ•°æ”¶è´¹ï¼‰ã€å¼¹æ€§èƒ½åŠ›å¼ºç­‰ç‰¹ç‚¹ã€‚é€šè¿‡ Virtual Kubelet æä¾›çš„ &lt;a href=&quot;https://github.com/virtual-kubelet/virtual-kubelet#current-features&quot;&gt;Kubernetes API&lt;/a&gt;ï¼ŒECI å°±èƒ½å’Œ K8S äº¤äº’ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ ECI ä¸Šæ‰§è¡Œåˆ›å»º Pod æˆ–è€…åˆ é™¤ Pod ç­‰æ“ä½œã€‚&lt;/p&gt;
&lt;h2 id=&quot;ä½¿ç”¨-virtual-kubelet-æ‰§è¡Œ-drone-ä»»åŠ¡çš„å¥½å¤„&quot;&gt;&lt;a href=&quot;#ä½¿ç”¨-virtual-kubelet-æ‰§è¡Œ-drone-ä»»åŠ¡çš„å¥½å¤„&quot; class=&quot;headerlink&quot; title=&quot;ä½¿ç”¨ virtual kubelet æ‰§è¡Œ drone ä»»åŠ¡çš„å¥½å¤„&quot;&gt;&lt;/a&gt;ä½¿ç”¨ virtual kubelet æ‰§è¡Œ drone ä»»åŠ¡çš„å¥½å¤„&lt;/h2&gt;&lt;p&gt;åœ¨ä½¿ç”¨ virtual kubelet ä¹‹å‰ï¼Œä¸ºäº†ä¸å½±å“ä¸šåŠ¡çš„ç¨³å®šæ€§ã€‚æˆ‘ä»¬çš„ K8S é›†ç¾¤ä¸­å¼€äº†å‡ å°å›ºå®šçš„ ECS å®ä¾‹ä¸“é—¨ç»™ CI ä½¿ç”¨ï¼ˆç»™è¿™äº› Node æ‰“ä¸Šäº†æ±¡ç‚¹ï¼Œæ‰€ä»¥ä¸šåŠ¡çš„æœåŠ¡ä¸ä¼šè°ƒåº¦åˆ°ä¸Šé¢ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§åšæ³•è™½ç„¶åœ¨ä¸å½±å“ä¸šåŠ¡çš„æƒ…å†µä¸‹ä¹Ÿä¿è¯äº† CI çš„ç¨³å®šè¿è¡Œï¼Œä½†æ˜¯å®ƒä¼šé€ æˆä¸€å®šç¨‹åº¦çš„æµªè´¹ã€‚å› ä¸º CI æœ¬èº«ä¸åƒå¤§å¤šæ•°ä¸šåŠ¡æœåŠ¡ï¼Œéœ€è¦ä¸€å¤© 24 å°æ—¶çš„è¿è¡Œã€‚CI çš„åœºæ™¯æ˜¯ç™½å¤©éœ€è¦å¾ˆå¤šèµ„æºï¼Œä½†æ˜¯åˆ°äº†æ™šä¸Šå‡ ä¹ä¸æ¶ˆè€—ä»»ä½•èµ„æºã€‚æ‰€ä»¥å¯ä»¥è¯´è¿™äº›æœºå™¨æœ‰æ¥è¿‘ 1/3 çš„æ—¶é—´æ˜¯åœ¨æµªè´¹ ğŸ’° çš„ã€‚&lt;/p&gt;
&lt;p&gt;è™½è¯´ K8S æœ¬èº«ä¹Ÿæä¾›äº†åŠ¨æ€æ‰©å®¹æœºåˆ¶ï¼Œå¯ä»¥è®¾ç½®å¾ˆå°‘çš„å›ºå®šèµ„æºå†é€šè¿‡ CA åŠ¨æ€æ‰©å®¹é›†ç¾¤æ¥å‡å°‘èµ„æºæ¶ˆè€—ã€‚ä½†æ˜¯ CA çš„å¯åŠ¨é€Ÿåº¦ï¼ˆåˆ†é’Ÿçº§ï¼‰æ»¡è¶³ä¸äº† CI è¿™ç§æ—¶æ•ˆè¦æ±‚é«˜çš„åœºæ™¯ã€‚&lt;/p&gt;</summary>
    
    
    
    
    <category term="ci/cd" scheme="https://blog.domc.me/tags/ci-cd/"/>
    
    <category term="drone" scheme="https://blog.domc.me/tags/drone/"/>
    
    <category term="devops" scheme="https://blog.domc.me/tags/devops/"/>
    
    <category term="kubernetes" scheme="https://blog.domc.me/tags/kubernetes/"/>
    
  </entry>
  
  <entry>
    <title>Drone åœ¨ K8S ä¸­æ‰§è¡Œä¸€æ¬¡æ„å»ºéƒ½ç»å†äº†ä»€ä¹ˆ</title>
    <link href="https://blog.domc.me/2019/10/22/drone-in-k8s/"/>
    <id>https://blog.domc.me/2019/10/22/drone-in-k8s/</id>
    <published>2019-10-22T14:37:10.000Z</published>
    <updated>2021-07-16T04:29:31.986Z</updated>
    
    
    <summary type="html">&lt;p&gt;åœ¨è°ˆè¿™ä¸ªé—®é¢˜ä¹‹å‰æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ drone çš„ç»“æ„ã€‚&lt;/p&gt;
&lt;h2 id=&quot;ç»“æ„&quot;&gt;&lt;a href=&quot;#ç»“æ„&quot; class=&quot;headerlink&quot; title=&quot;ç»“æ„&quot;&gt;&lt;/a&gt;ç»“æ„&lt;/h2&gt;&lt;p&gt;drone ç”± 3 ä¸ªä¸»è¦çš„éƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯ &lt;code&gt;drone-server&lt;/code&gt;ã€&lt;code&gt;drone-controller&lt;/code&gt; å’Œ &lt;code&gt;drone-agent&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&quot;drone-server&quot;&gt;&lt;a href=&quot;#drone-server&quot; class=&quot;headerlink&quot; title=&quot;drone-server&quot;&gt;&lt;/a&gt;drone-server&lt;/h3&gt;&lt;p&gt;é¡¾åæ€ä¹‰ï¼Œ&lt;code&gt;drone-server&lt;/code&gt; æ˜¯ drone çš„æœåŠ¡ç«¯ï¼Œå®ƒä¼šå¯åŠ¨ä¸€ä¸ª &lt;code&gt;http&lt;/code&gt; æœåŠ¡æ¥å¤„ç†å„ç§è¯·æ±‚ï¼Œå¦‚ github æ¯æ¬¡ push æˆ–è€…å…¶ä»–æ“ä½œè§¦å‘çš„ webhook äº¦æˆ–è€…æ˜¯ &lt;code&gt;drone-web-ui&lt;/code&gt; çš„æ¯ä¸ªè¯·æ±‚ã€‚&lt;/p&gt;
&lt;h3 id=&quot;drone-controller&quot;&gt;&lt;a href=&quot;#drone-controller&quot; class=&quot;headerlink&quot; title=&quot;drone-controller&quot;&gt;&lt;/a&gt;drone-controller&lt;/h3&gt;&lt;p&gt;controller çš„ä½œç”¨æ˜¯åˆå§‹åŒ– pipeline ä¿¡æ¯ï¼Œå®ƒä¼šå®šä¹‰å¥½ pipeline çš„æ¯ä¸ª step åœ¨æ‰§è¡Œä¹‹å‰ã€æ‰§è¡Œä¹‹åä»¥åŠè·å–å’Œå†™å…¥æ‰§è¡Œæ—¥å¿—çš„å‡½æ•°ï¼Œå¹¶ä¿è¯æ¯ä¸ª pipeline èƒ½æŒ‰é¡ºåºæ‰§è¡Œ stepã€‚&lt;/p&gt;
&lt;h3 id=&quot;drone-agent&quot;&gt;&lt;a href=&quot;#drone-agent&quot; class=&quot;headerlink&quot; title=&quot;drone-agent&quot;&gt;&lt;/a&gt;drone-agent&lt;/h3&gt;&lt;p&gt;å¯ä»¥å°† &lt;code&gt;drone-agent&lt;/code&gt; åœ¨ &lt;code&gt;drone&lt;/code&gt; ä¸­çš„ä½œç”¨ç®€å•çš„ç†è§£ä¸ºæ˜¯ &lt;code&gt;kubelet&lt;/code&gt; åœ¨ &lt;code&gt;k8s&lt;/code&gt; ä¸­çš„ä½œç”¨ï¼Œå› ä¸ºæœ¬æ–‡ä¸»è¦è®¨è®ºçš„æ˜¯ drone åœ¨ k8s ä¸­çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œåœ¨ k8s ä¸­ï¼Œdrone çš„æ‰§è¡Œå¹¶ä¸ä¾èµ– &lt;code&gt;drone-agent&lt;/code&gt;ï¼Œæ‰€ä»¥æœ¬æ–‡å¹¶ä¸ä¼šå¯¹è¯¥ç»„ä»¶åšè¯¦ç»†ä»‹ç»ã€‚&lt;/p&gt;</summary>
    
    
    
    
    <category term="drone" scheme="https://blog.domc.me/tags/drone/"/>
    
    <category term="devops" scheme="https://blog.domc.me/tags/devops/"/>
    
    <category term="kubernetes" scheme="https://blog.domc.me/tags/kubernetes/"/>
    
    <category term="CI/CD" scheme="https://blog.domc.me/tags/CI-CD/"/>
    
  </entry>
  
  <entry>
    <title>kubectl run èƒŒååšäº†ä»€ä¹ˆ</title>
    <link href="https://blog.domc.me/2019/08/29/kubectl-run/"/>
    <id>https://blog.domc.me/2019/08/29/kubectl-run/</id>
    <published>2019-08-29T16:18:17.000Z</published>
    <updated>2021-07-16T04:29:31.986Z</updated>
    
    
    <summary type="html">&lt;p&gt;è¿™ç¯‡æ–‡ç« éšä¾¿å†™å†™ï¼Œåªå†™æµç¨‹ï¼Œä¸å†™åŸç†&lt;/p&gt;
&lt;h2 id=&quot;æ‰§è¡Œ-kubectl-run&quot;&gt;&lt;a href=&quot;#æ‰§è¡Œ-kubectl-run&quot; class=&quot;headerlink&quot; title=&quot;æ‰§è¡Œ kubectl run&quot;&gt;&lt;/a&gt;æ‰§è¡Œ kubectl run&lt;/h2&gt;&lt;h3 id=&quot;Api-Server&quot;&gt;&lt;a href=&quot;#Api-Server&quot; class=&quot;headerlink&quot; title=&quot;Api Server&quot;&gt;&lt;/a&gt;Api Server&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;æœ¬åœ°éªŒè¯ï¼Œç¡®ä¿ä¸åˆæ³•çš„è¯·æ±‚ï¼ˆæ¯”å¦‚ï¼šåˆ›å»ºä¸æ”¯æŒçš„èµ„æºæˆ–è€…æ ¼å¼ä¸å¯¹ç­‰ç­‰ï¼‰ä¼šå¿«é€Ÿå¤±è´¥ï¼Œä¸ä¼šå‘ç»™ api-serverï¼Œå‡è½»æœåŠ¡ç«¯å‹åŠ›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å‡†å¤‡å‘ api-server å‘é€ HTTP è¯·æ±‚ï¼Œå°†ä¿®æ”¹åçš„æ•°æ®è¿›è¡Œåºåˆ—åŒ–ã€‚ä½†æ˜¯ URI PATH æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè¿™é‡Œå°±ä¾èµ–èµ„æºå†…çš„ apiVersion è¿™ä¸ªå€¼ï¼Œå†åŠ ä¸Šèµ„æºç±»å‹ï¼Œkubectl å°±èƒ½åœ¨ api åˆ—è¡¨ä¸­æ‰¾åˆ°åº”è¯¥å‘å¾€çš„åœ°å€ã€‚api åˆ—è¡¨å¯ä»¥é€šè¿‡ api-server çš„ /apis è¿™ä¸ª URL è·å–ï¼Œè·å–ä¹‹åä¼šåœ¨æœ¬åœ°ç¼“å­˜ä¸€ä»½ï¼Œæé«˜æ•ˆç‡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;api-server è‚¯å®šä¸ä¼šæ¥å—ä¸åˆæ³•çš„è¯·æ±‚ï¼Œæ‰€ä»¥ kubectl è¿˜è¦åœ¨è¯·æ±‚ä¹‹å‰è®¾ç½®å¥½è®¤è¯ä¿¡æ¯ã€‚è®¤è¯ä¿¡æ¯ä¸€èˆ¬å¯ä»¥ä» ~/.kube/config ä¸­è·å–ï¼Œå®ƒæ”¯æŒ 4 ç§ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;tls: éœ€è¦ä½¿ç”¨ x509 è¯ä¹¦&lt;/li&gt;
&lt;li&gt;token: åœ¨ HEADER ä¸­æ·»åŠ  Authorization&lt;/li&gt;
&lt;li&gt;basic username password: åŸºæœ¬çš„è´¦å·å¯†ç è®¤è¯&lt;/li&gt;
&lt;li&gt;openid: ç±»ä¼¼äº tokenï¼Œopenid ç”±ç”¨æˆ·äº‹å…ˆæ‰‹åŠ¨è®¾ç½®&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è¿™æ—¶ api-server å·²ç»æˆåŠŸæ¥æ”¶åˆ°äº†è¯·æ±‚ã€‚å®ƒä¼šåˆ¤æ–­æˆ‘ä»¬æ˜¯ä¸æ˜¯æœ‰æƒé™æ“ä½œè¿™ä¸ªèµ„æºã€‚é‚£ä¹ˆæ€ä¹ˆéªŒè¯å‘¢ï¼Œåœ¨ api-server å¯åŠ¨çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡å‚æ•° â€“authorization_mode è¿›è¡Œè®¾ç½®ï¼Œè¿™ä¸ªå€¼æœ‰ 4 ç§ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;webhook: ä¸é›†ç¾¤å¤–çš„ HTTPS æœåŠ¡äº¤äº’&lt;/li&gt;
&lt;li&gt;ABAC: é™æ€æ–‡ä»¶å®šä¹‰çš„ç­–ç•¥&lt;/li&gt;
&lt;li&gt;RBAC: åŠ¨æ€é…ç½®çš„ç­–ç•¥&lt;/li&gt;
&lt;li&gt;Node: æ¯ä¸ª kubelet åªèƒ½è®¿é—®è‡ªå·±èŠ‚ç‚¹ä¸Šçš„èµ„æº&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt; å¦‚æœé…ç½®äº†å¤šç§æˆæƒæ–¹å¼ï¼Œåªè¦å…¶ä¸­ä¸€ç§èƒ½é€šè¿‡é‚£ä¹ˆè¯·æ±‚å°±èƒ½ç»§ç»­ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æˆæƒé€šè¿‡äº†ï¼Œä½†æ˜¯ç°åœ¨ä»ç„¶è¿˜ä¸èƒ½å¤Ÿå‘ etcd ä¸­å†™æ•°æ®ï¼Œè¿˜éœ€è¦ç»è¿‡&lt;code&gt;å‡†å…¥æ§åˆ¶é“¾&lt;/code&gt;è¿™é“å…³å¡ã€‚å‡†å…¥æ§åˆ¶é“¾ç”± &lt;code&gt;Admission Controller&lt;/code&gt; æ§åˆ¶ã€‚å®˜æ–¹æ ‡å‡†çš„å‡†å…¥æ§åˆ¶é“¾æœ‰è¿‘ 10 ä¸ªä¹‹å¤šï¼Œè€Œä¸”æ”¯æŒè‡ªå®šä¹‰æ‰©å±•ã€‚ä¸åŒäºæˆæƒï¼Œå‡†å…¥æ§åˆ¶é“¾ä¸€æ—¦æœ‰ä¸€ä¸ªéªŒè¯å¤±è´¥ï¼Œé‚£ä¹ˆè¯·æ±‚å°±ä¼šè¢«æ‹’ç»ã€‚ä»¥ä¸‹ä»‹ç»ä¸‰ä¸ªå‡†å…¥æ§åˆ¶å™¨ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;SecurityContextDeny: ç¦æ­¢åˆ›å»ºè®¾ç½®äº† Security Context çš„ Pod&lt;/li&gt;
&lt;li&gt;ResourceQuota: é™åˆ¶æŸä¸ª Namespace ä¸‹æ€»ç³»ç»Ÿèµ„æºçš„å ç”¨é‡å’Œèµ„æºçš„æ•°é‡&lt;/li&gt;
&lt;li&gt;LimitRanger: é™åˆ¶æŸä¸ª Namespace ä¸‹å•ä¸ªèµ„æºçš„å ç”¨é‡&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;é€šè¿‡ä¸Šé¢æ‰€æœ‰éªŒè¯åï¼Œapi-server å°† kubectl æäº¤çš„æ•°æ®ååºåˆ—åŒ–ï¼Œç„¶åä¿å­˜åˆ° etcd ä¸­ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;</summary>
    
    
    
    
    <category term="kubernetes" scheme="https://blog.domc.me/tags/kubernetes/"/>
    
  </entry>
  
  <entry>
    <title>kubeDNSå’ŒcoreDNS</title>
    <link href="https://blog.domc.me/2019/08/07/kube-dns-and-core-dns/"/>
    <id>https://blog.domc.me/2019/08/07/kube-dns-and-core-dns/</id>
    <published>2019-08-07T21:32:39.000Z</published>
    <updated>2021-07-16T04:29:31.986Z</updated>
    
    
    <summary type="html">&lt;p&gt;æœ¬ç¯‡æ–‡ç« ä¸»è¦å›´ç»•ä¸¤ç§ DNS Server çš„å®ç°æ–¹å¼å±•å¼€ï¼Œä¼šæ¯”è¾ƒä¸¤ç§ Server çš„ä¼˜ç¼ºç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¯´ä¸¤ä¸ª Service ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹åœ¨k8sä¸­åŸŸåæ˜¯å¦‚ä½•è¢«è§£æçš„ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œåœ¨ k8s ä¸­ï¼Œä¸€ä¸ª Pod å¦‚æœè¦è®¿é—®åŒ Namespace ä¸‹çš„ Serviceï¼ˆæ¯”å¦‚ user-svcï¼‰ï¼Œé‚£ä¹ˆåªéœ€è¦curl user-svcã€‚å¦‚æœ Pod å’Œ Service ä¸åœ¨åŒä¸€åŸŸåä¸‹ï¼Œé‚£ä¹ˆå°±éœ€è¦åœ¨ Service Name ä¹‹åæ·»åŠ ä¸Š Service æ‰€åœ¨çš„ Namespaceï¼ˆæ¯”å¦‚ betaï¼‰ï¼Œcurl user-svc.betaã€‚é‚£ä¹ˆ k8s æ˜¯å¦‚ä½•çŸ¥é“è¿™äº›åŸŸåæ˜¯å†…éƒ¨åŸŸåå¹¶ä¸ºä»–ä»¬åšè§£æçš„å‘¢ï¼Ÿ&lt;/p&gt;</summary>
    
    
    
    
    <category term="kubernetes" scheme="https://blog.domc.me/tags/kubernetes/"/>
    
    <category term="dns" scheme="https://blog.domc.me/tags/dns/"/>
    
  </entry>
  
  <entry>
    <title>golang sync.Mapæºç è§£æ</title>
    <link href="https://blog.domc.me/2019/03/01/golang-sync-map/"/>
    <id>https://blog.domc.me/2019/03/01/golang-sync-map/</id>
    <published>2019-03-01T14:04:44.000Z</published>
    <updated>2021-07-16T04:29:31.986Z</updated>
    
    
    <summary type="html">&lt;p&gt;golangçš„å†…å»ºç±»å‹mapæ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨å¹¶å‘æ“ä½œå»å†™mapæ—¶ä¼šå¼•å‘panic&lt;/p&gt;
&lt;figure class=&quot;highlight go&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;package&lt;/span&gt; main&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; (&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;string&quot;&gt;&amp;quot;fmt&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;string&quot;&gt;&amp;quot;sync&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; m = &lt;span class=&quot;built_in&quot;&gt;make&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;map&lt;/span&gt;[&lt;span class=&quot;keyword&quot;&gt;string&lt;/span&gt;]&lt;span class=&quot;keyword&quot;&gt;string&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; wait  sync.WaitGroup&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; i := &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; ;i &amp;lt; &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt; ; i ++ &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		wait.Add(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;go&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			m[fmt.Sprintf(&lt;span class=&quot;string&quot;&gt;&amp;quot;%d&amp;quot;&lt;/span&gt;,i)] = &lt;span class=&quot;string&quot;&gt;&amp;quot;test&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			wait.Done()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&amp;#125;()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	wait.Wait()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    
    <category term="golang" scheme="https://blog.domc.me/tags/golang/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•ç”¨Rediså®ç°ä¸€ä¸ªæŒ‡å®šæ—¶é—´çš„é™é€Ÿå™¨</title>
    <link href="https://blog.domc.me/2019/02/28/redis-limit/"/>
    <id>https://blog.domc.me/2019/02/28/redis-limit/</id>
    <published>2019-02-28T14:53:58.000Z</published>
    <updated>2021-07-16T04:29:31.986Z</updated>
    
    
    <summary type="html">&lt;p&gt;ä½¿ç”¨Redisçš„&lt;code&gt;Incr&lt;/code&gt;å¯ä»¥å¾ˆå®¹æ˜“çš„å®ç°ä¸€ä¸ªé™é€Ÿå™¨&lt;/p&gt;
&lt;p&gt;åœ¨redisçš„å®˜æ–¹æ–‡æ¡£ä¸­ä¹Ÿæœ‰è¯¦ç»†çš„ç¤ºä¾‹&lt;/p&gt;
&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;FUNCTION &lt;span class=&quot;title&quot;&gt;LIMIT_API_CALL&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(ip)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;ts &lt;/span&gt;= CURRENT_UNIX_TIME()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;keyname = ip+&lt;span class=&quot;string&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt;+ts&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;current = GET(keyname)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;IF current != &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt; AND current &amp;gt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt; THEN&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ERROR &lt;span class=&quot;string&quot;&gt;&amp;quot;too many requests per second&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;END&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;IF current == &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt; THEN&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    MULTI&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        INCR(keyname, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        EXPIRE(keyname, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    EXEC&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ELSE&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    INCR(keyname, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;END&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;PERFORM_API_CALL()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    
    <category term="redis" scheme="https://blog.domc.me/tags/redis/"/>
    
  </entry>
  
  <entry>
    <title>è§£å†³golangä½¿ç”¨elasticè¿æ¥elasticsearchæ—¶è‡ªåŠ¨è½¬æ¢è¿æ¥åœ°å€</title>
    <link href="https://blog.domc.me/2019/02/28/golang-elastic-url/"/>
    <id>https://blog.domc.me/2019/02/28/golang-elastic-url/</id>
    <published>2019-02-28T14:53:27.000Z</published>
    <updated>2021-07-16T04:29:31.986Z</updated>
    
    
    <summary type="html">&lt;p&gt;ä½¿ç”¨&lt;a href=&quot;https://github.com/olivere/elastic&quot;&gt;olivere/&lt;em&gt;elastic&lt;/em&gt;&lt;/a&gt;è¿æ¥elasticsearchæ—¶ï¼Œå‘ç°è¿æ¥åœ°å€æ˜æ˜è¾“å…¥çš„æ—¶å€™æ˜¯å…¬ç½‘åœ°å€ï¼Œä½†æ˜¯è¿æ¥æ—¶ä¼šè‡ªåŠ¨è½¬æ¢æˆå†…ç½‘åœ°å€æˆ–è€…dockerä¸­çš„ipåœ°å€ï¼Œå¯¼è‡´æœåŠ¡è¿æ¥ä¸ä¸Šã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;// è‡ªåŠ¨è½¬æ¢æˆdockerä¸­çš„ipå¯¼è‡´æ— æ³•è¿æ¥æœåŠ¡&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time=&amp;quot;2019-02-15T20:04:26+08:00&amp;quot; level=error msg=&amp;quot;Head http://172.17.0.2:9200: context deadline exceeded&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&quot;è§£å†³æ–¹æ³•&quot;&gt;&lt;a href=&quot;#è§£å†³æ–¹æ³•&quot; class=&quot;headerlink&quot; title=&quot;è§£å†³æ–¹æ³•&quot;&gt;&lt;/a&gt;è§£å†³æ–¹æ³•&lt;/h2&gt;</summary>
    
    
    
    
    <category term="golang" scheme="https://blog.domc.me/tags/golang/"/>
    
    <category term="elasticsearch" scheme="https://blog.domc.me/tags/elasticsearch/"/>
    
  </entry>
  
  <entry>
    <title>github ç§»é™¤æ•æ„Ÿæ–‡ä»¶æäº¤è®°å½•</title>
    <link href="https://blog.domc.me/2019/02/28/github-sensitive/"/>
    <id>https://blog.domc.me/2019/02/28/github-sensitive/</id>
    <published>2019-02-28T14:52:51.000Z</published>
    <updated>2021-07-16T04:29:31.986Z</updated>
    
    
    <summary type="html">&lt;p&gt;åœ¨å¾€githubæäº¤ä»£ç æ—¶ï¼Œæœ‰å¯èƒ½ä¼šå°†ä¸€äº›ç§å¯†ä¿¡æ¯æäº¤åˆ°ä»“åº“ï¼Œå³ä½¿åç»­åˆ é™¤è¯¥æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶çš„å†…å®¹ä¾ç„¶å¯ä»¥åœ¨githubçš„æäº¤è®°å½•ä¸­è¢«æ‰¾åˆ°ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤å¦‚æœéœ€è¦æ•°æ®ä»historyä¸­åˆ é™¤ï¼Œå¯ä»¥ä½¿ç”¨&lt;code&gt;git filter-branch&lt;/code&gt;å‘½ä»¤æˆ–BFG Repo-Cleanerå¼€æºå·¥å…·ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ä¸»è¦ä»‹ç»å¦‚ä½•ä½¿ç”¨&lt;code&gt;git filter-branch&lt;/code&gt;å‘½ä»¤æ¸…é™¤historyä¸­æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚&lt;/p&gt;
&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æ¸…é™¤äº†historyä¸­çš„è®°å½•ï¼Œåç»­æˆ‘ä»¬å°†æ— æ³•ä½¿ç”¨å…¶ä»–å‘½ä»¤æŸ¥çœ‹è¯¥æ–‡ä»¶çš„æäº¤è®°å½•å’Œå˜åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢å¼€å§‹ä½¿ç”¨git filter-branchæ¸…é™¤æ–‡ä»¶æäº¤è®°å½•&lt;/p&gt;</summary>
    
    
    
    
    <category term="git" scheme="https://blog.domc.me/tags/git/"/>
    
    <category term="github" scheme="https://blog.domc.me/tags/github/"/>
    
  </entry>
  
  <entry>
    <title>[Golang] http.Requestå¤ç”¨</title>
    <link href="https://blog.domc.me/2019/02/28/golang-http-request/"/>
    <id>https://blog.domc.me/2019/02/28/golang-http-request/</id>
    <published>2019-02-28T14:49:45.000Z</published>
    <updated>2021-07-16T04:29:31.986Z</updated>
    
    
    <summary type="html">&lt;p&gt;&lt;strong&gt;å¤ç”¨é’ˆå¯¹é™¤äº†Getä»¥å¤–çš„è¯·æ±‚&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight go&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;package&lt;/span&gt; main&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; (&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;string&quot;&gt;&amp;quot;net/http&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;string&quot;&gt;&amp;quot;strings&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        reader := strings.NewReader(&lt;span class=&quot;string&quot;&gt;&amp;quot;hello&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	req,_ := http.NewRequest(&lt;span class=&quot;string&quot;&gt;&amp;quot;POST&amp;quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&amp;quot;http://www.abc.com&amp;quot;&lt;/span&gt;,reader)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	client := http.Client&amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	client.Do(req) &lt;span class=&quot;comment&quot;&gt;// ç¬¬ä¸€æ¬¡ä¼šè¯·æ±‚æˆåŠŸ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	client.Do(req) &lt;span class=&quot;comment&quot;&gt;// è¯·æ±‚å¤±è´¥&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    
    <category term="golang" scheme="https://blog.domc.me/tags/golang/"/>
    
    <category term="http" scheme="https://blog.domc.me/tags/http/"/>
    
  </entry>
  
</feed>
